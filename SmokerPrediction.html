<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Smoker predictions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SmokerPrediction_files/libs/clipboard/clipboard.min.js"></script>
<script src="SmokerPrediction_files/libs/quarto-html/quarto.js"></script>
<script src="SmokerPrediction_files/libs/quarto-html/popper.min.js"></script>
<script src="SmokerPrediction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SmokerPrediction_files/libs/quarto-html/anchor.min.js"></script>
<link href="SmokerPrediction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SmokerPrediction_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SmokerPrediction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SmokerPrediction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SmokerPrediction_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#reading-and-preprocessing-data" id="toc-reading-and-preprocessing-data" class="nav-link" data-scroll-target="#reading-and-preprocessing-data">Reading and preprocessing data</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">Heatmap</a></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age">Age</a></li>
  <li><a href="#weight" id="toc-weight" class="nav-link" data-scroll-target="#weight">Weight</a></li>
  <li><a href="#height" id="toc-height" class="nav-link" data-scroll-target="#height">Height</a></li>
  <li><a href="#waist" id="toc-waist" class="nav-link" data-scroll-target="#waist">Waist</a></li>
  <li><a href="#eyesight-left-right" id="toc-eyesight-left-right" class="nav-link" data-scroll-target="#eyesight-left-right">Eyesight [left, right]</a></li>
  <li><a href="#hearing-left-right" id="toc-hearing-left-right" class="nav-link" data-scroll-target="#hearing-left-right">Hearing [left, right]</a></li>
  <li><a href="#systolic" id="toc-systolic" class="nav-link" data-scroll-target="#systolic">Systolic</a></li>
  <li><a href="#relaxation" id="toc-relaxation" class="nav-link" data-scroll-target="#relaxation">Relaxation</a></li>
  <li><a href="#fasting-blood-sugar" id="toc-fasting-blood-sugar" class="nav-link" data-scroll-target="#fasting-blood-sugar">Fasting blood sugar</a></li>
  <li><a href="#cholesterol" id="toc-cholesterol" class="nav-link" data-scroll-target="#cholesterol">Cholesterol</a></li>
  <li><a href="#triglyceride" id="toc-triglyceride" class="nav-link" data-scroll-target="#triglyceride">Triglyceride</a></li>
  <li><a href="#hdl" id="toc-hdl" class="nav-link" data-scroll-target="#hdl">HDL</a></li>
  <li><a href="#ldl" id="toc-ldl" class="nav-link" data-scroll-target="#ldl">LDL</a></li>
  <li><a href="#hemoglobin" id="toc-hemoglobin" class="nav-link" data-scroll-target="#hemoglobin">Hemoglobin</a></li>
  <li><a href="#urine-protein" id="toc-urine-protein" class="nav-link" data-scroll-target="#urine-protein">Urine protein</a></li>
  <li><a href="#serum-creatinine" id="toc-serum-creatinine" class="nav-link" data-scroll-target="#serum-creatinine">Serum creatinine</a></li>
  <li><a href="#ast" id="toc-ast" class="nav-link" data-scroll-target="#ast">AST</a></li>
  <li><a href="#alt" id="toc-alt" class="nav-link" data-scroll-target="#alt">ALT</a></li>
  <li><a href="#gtp" id="toc-gtp" class="nav-link" data-scroll-target="#gtp">Gtp</a></li>
  <li><a href="#dental-caries" id="toc-dental-caries" class="nav-link" data-scroll-target="#dental-caries">Dental caries</a></li>
  <li><a href="#smoking" id="toc-smoking" class="nav-link" data-scroll-target="#smoking">Smoking</a></li>
  <li><a href="#conclusions-on-data" id="toc-conclusions-on-data" class="nav-link" data-scroll-target="#conclusions-on-data">Conclusions on data</a></li>
  </ul></li>
  <li><a href="#data-preparation-for-categorization" id="toc-data-preparation-for-categorization" class="nav-link" data-scroll-target="#data-preparation-for-categorization">Data preparation for categorization</a></li>
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training">Training</a>
  <ul class="collapse">
  <li><a href="#creating-transformers-for-data" id="toc-creating-transformers-for-data" class="nav-link" data-scroll-target="#creating-transformers-for-data">Creating transformers for data</a></li>
  <li><a href="#training-logistic-regression" id="toc-training-logistic-regression" class="nav-link" data-scroll-target="#training-logistic-regression">Training Logistic regression</a></li>
  <li><a href="#random-forest-classifier" id="toc-random-forest-classifier" class="nav-link" data-scroll-target="#random-forest-classifier">Random forest classifier</a></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a></li>
  <li><a href="#sgd-classifier" id="toc-sgd-classifier" class="nav-link" data-scroll-target="#sgd-classifier">SGD Classifier</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#submission-of-my-predictions" id="toc-submission-of-my-predictions" class="nav-link" data-scroll-target="#submission-of-my-predictions">Submission of my predictions</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Smoker predictions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>This semestral work is focused on prediction of whether a person is a smoker or not, based on biological data such as height, weight, blood pressure, etc.</p>
<p>This work is tied to Kaggle competition with the name of <a href="https://www.kaggle.com/competitions/playground-series-s3e24/overview">Binary Prediction of Smoker Status using Bio-Signals</a>.</p>
</section>
<section id="reading-and-preprocessing-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-and-preprocessing-data">Reading and preprocessing data</h2>
<p>Those are all of the libraries and functions used for this project.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, MinMaxScaler, StandardScaler</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression, LogisticRegressionCV,SGDClassifier</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.kernel_approximation <span class="im">import</span> RBFSampler</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, cross_validate, RandomizedSearchCV</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'Smokers/train.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">height(cm)</th>
<th data-quarto-table-cell-role="th">weight(kg)</th>
<th data-quarto-table-cell-role="th">waist(cm)</th>
<th data-quarto-table-cell-role="th">eyesight(left)</th>
<th data-quarto-table-cell-role="th">eyesight(right)</th>
<th data-quarto-table-cell-role="th">hearing(left)</th>
<th data-quarto-table-cell-role="th">hearing(right)</th>
<th data-quarto-table-cell-role="th">systolic</th>
<th data-quarto-table-cell-role="th">relaxation</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">HDL</th>
<th data-quarto-table-cell-role="th">LDL</th>
<th data-quarto-table-cell-role="th">hemoglobin</th>
<th data-quarto-table-cell-role="th">Urine protein</th>
<th data-quarto-table-cell-role="th">serum creatinine</th>
<th data-quarto-table-cell-role="th">AST</th>
<th data-quarto-table-cell-role="th">ALT</th>
<th data-quarto-table-cell-role="th">Gtp</th>
<th data-quarto-table-cell-role="th">dental caries</th>
<th data-quarto-table-cell-role="th">smoking</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>55</td>
<td>165</td>
<td>60</td>
<td>81.0</td>
<td>0.5</td>
<td>0.6</td>
<td>1</td>
<td>1</td>
<td>135</td>
<td>87</td>
<td>...</td>
<td>40</td>
<td>75</td>
<td>16.5</td>
<td>1</td>
<td>1.0</td>
<td>22</td>
<td>25</td>
<td>27</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>70</td>
<td>165</td>
<td>65</td>
<td>89.0</td>
<td>0.6</td>
<td>0.7</td>
<td>2</td>
<td>2</td>
<td>146</td>
<td>83</td>
<td>...</td>
<td>57</td>
<td>126</td>
<td>16.2</td>
<td>1</td>
<td>1.1</td>
<td>27</td>
<td>23</td>
<td>37</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>20</td>
<td>170</td>
<td>75</td>
<td>81.0</td>
<td>0.4</td>
<td>0.5</td>
<td>1</td>
<td>1</td>
<td>118</td>
<td>75</td>
<td>...</td>
<td>45</td>
<td>93</td>
<td>17.4</td>
<td>1</td>
<td>0.8</td>
<td>27</td>
<td>31</td>
<td>53</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>35</td>
<td>180</td>
<td>95</td>
<td>105.0</td>
<td>1.5</td>
<td>1.2</td>
<td>1</td>
<td>1</td>
<td>131</td>
<td>88</td>
<td>...</td>
<td>38</td>
<td>102</td>
<td>15.9</td>
<td>1</td>
<td>1.0</td>
<td>20</td>
<td>27</td>
<td>30</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>30</td>
<td>165</td>
<td>60</td>
<td>80.5</td>
<td>1.5</td>
<td>1.0</td>
<td>1</td>
<td>1</td>
<td>121</td>
<td>76</td>
<td>...</td>
<td>44</td>
<td>93</td>
<td>15.4</td>
<td>1</td>
<td>0.8</td>
<td>19</td>
<td>13</td>
<td>17</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>5 rows × 23 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">height(cm)</th>
<th data-quarto-table-cell-role="th">weight(kg)</th>
<th data-quarto-table-cell-role="th">waist(cm)</th>
<th data-quarto-table-cell-role="th">eyesight(left)</th>
<th data-quarto-table-cell-role="th">eyesight(right)</th>
<th data-quarto-table-cell-role="th">hearing(left)</th>
<th data-quarto-table-cell-role="th">hearing(right)</th>
<th data-quarto-table-cell-role="th">systolic</th>
<th data-quarto-table-cell-role="th">relaxation</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">HDL</th>
<th data-quarto-table-cell-role="th">LDL</th>
<th data-quarto-table-cell-role="th">hemoglobin</th>
<th data-quarto-table-cell-role="th">Urine protein</th>
<th data-quarto-table-cell-role="th">serum creatinine</th>
<th data-quarto-table-cell-role="th">AST</th>
<th data-quarto-table-cell-role="th">ALT</th>
<th data-quarto-table-cell-role="th">Gtp</th>
<th data-quarto-table-cell-role="th">dental caries</th>
<th data-quarto-table-cell-role="th">smoking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>...</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.00</td>
<td>159256.0</td>
<td>159256.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>44.31</td>
<td>165.27</td>
<td>67.14</td>
<td>83.00</td>
<td>1.01</td>
<td>1.00</td>
<td>1.02</td>
<td>1.02</td>
<td>122.50</td>
<td>76.87</td>
<td>...</td>
<td>55.85</td>
<td>114.61</td>
<td>14.80</td>
<td>1.07</td>
<td>0.89</td>
<td>25.52</td>
<td>26.55</td>
<td>36.22</td>
<td>0.2</td>
<td>0.44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>11.84</td>
<td>8.82</td>
<td>12.59</td>
<td>8.96</td>
<td>0.40</td>
<td>0.39</td>
<td>0.15</td>
<td>0.15</td>
<td>12.73</td>
<td>8.99</td>
<td>...</td>
<td>13.96</td>
<td>28.16</td>
<td>1.43</td>
<td>0.35</td>
<td>0.18</td>
<td>9.46</td>
<td>17.75</td>
<td>31.20</td>
<td>0.4</td>
<td>0.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>20.00</td>
<td>135.00</td>
<td>30.00</td>
<td>51.00</td>
<td>0.10</td>
<td>0.10</td>
<td>1.00</td>
<td>1.00</td>
<td>77.00</td>
<td>44.00</td>
<td>...</td>
<td>9.00</td>
<td>1.00</td>
<td>4.90</td>
<td>1.00</td>
<td>0.10</td>
<td>6.00</td>
<td>1.00</td>
<td>2.00</td>
<td>0.0</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>40.00</td>
<td>160.00</td>
<td>60.00</td>
<td>77.00</td>
<td>0.80</td>
<td>0.80</td>
<td>1.00</td>
<td>1.00</td>
<td>114.00</td>
<td>70.00</td>
<td>...</td>
<td>45.00</td>
<td>95.00</td>
<td>13.80</td>
<td>1.00</td>
<td>0.80</td>
<td>20.00</td>
<td>16.00</td>
<td>18.00</td>
<td>0.0</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>40.00</td>
<td>165.00</td>
<td>65.00</td>
<td>83.00</td>
<td>1.00</td>
<td>1.00</td>
<td>1.00</td>
<td>1.00</td>
<td>121.00</td>
<td>78.00</td>
<td>...</td>
<td>54.00</td>
<td>114.00</td>
<td>15.00</td>
<td>1.00</td>
<td>0.90</td>
<td>24.00</td>
<td>22.00</td>
<td>27.00</td>
<td>0.0</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>55.00</td>
<td>170.00</td>
<td>75.00</td>
<td>89.00</td>
<td>1.20</td>
<td>1.20</td>
<td>1.00</td>
<td>1.00</td>
<td>130.00</td>
<td>82.00</td>
<td>...</td>
<td>64.00</td>
<td>133.00</td>
<td>15.80</td>
<td>1.00</td>
<td>1.00</td>
<td>29.00</td>
<td>32.00</td>
<td>44.00</td>
<td>0.0</td>
<td>1.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>85.00</td>
<td>190.00</td>
<td>130.00</td>
<td>127.00</td>
<td>9.90</td>
<td>9.90</td>
<td>2.00</td>
<td>2.00</td>
<td>213.00</td>
<td>133.00</td>
<td>...</td>
<td>136.00</td>
<td>1860.00</td>
<td>21.00</td>
<td>6.00</td>
<td>9.90</td>
<td>778.00</td>
<td>2914.00</td>
<td>999.00</td>
<td>1.0</td>
<td>1.00</td>
</tr>
</tbody>
</table>

<p>8 rows × 23 columns</p>
</div>
</div>
</div>
<p>In the dataset we can notice that hearing is split into hearing left and right, with 1 indicating good hearing, and 2 indicating deafness (presumably).</p>
<p>For the sake of easier plotting and clearer interpretation, I will combine them into one variable and ommit which ear is deaf.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> [<span class="st">"Both hearing"</span>, <span class="st">"One deaf"</span>, <span class="st">"Both deaf"</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>hear <span class="op">=</span> data.loc[:, [<span class="st">"hearing(left)"</span>, <span class="st">"hearing(right)"</span>]]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>hearing <span class="op">=</span> []</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> hear.iterrows():</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    hearing.append(idx[row.iloc[<span class="dv">0</span>] <span class="op">+</span> row.iloc[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span>])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data.loc[:, <span class="st">"hearing"</span>] <span class="op">=</span> hearing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In case of other variables I see no need to immidiately edit them.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>Dataset contains both numeric and categorical data.</p>
<p>Numeric data are: age, height, waist, eyesight, systolic and relaxed blood pressure, fasting blood sugar, cholesterol, triglyceride, serum creatinine, AST, ALT, Gtp</p>
<p>Categorical data are: urine protein, hearing, dental caries, smoking (target variable)</p>
<section id="heatmap" class="level3">
<h3 class="anchored" data-anchor-id="heatmap">Heatmap</h3>
<p>Let’s take a look at the correlation matrix for all of numeric variables.</p>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-7-output-1.png" width="727" height="605"></p>
</div>
</div>
<p>There are some correlations, although it they don’t seem to be too strong for the most part.</p>
<p>Here I will dedicate whole section to each variable where I will be plotting them with variables which showed some correlation and with categorical variables (in case of section of numeric variables).</p>
</section>
<section id="age" class="level3">
<h3 class="anchored" data-anchor-id="age">Age</h3>
<p>From correlation heatmap we can see that age is negatively correlated with height, weight and eyesight. However, the correlation matrix is only done for numeric values, so let’s take a look on it’s relationship with categorical variables as well.</p>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-8-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-9-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-10-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-11-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-12-output-1.png" width="585" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-13-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-14-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-15-output-1.png" width="585" height="429"></p>
</div>
</div>
</section>
<section id="weight" class="level3">
<h3 class="anchored" data-anchor-id="weight">Weight</h3>
<p>From correlation heatmap, weight came out as positively correlated with waist and height. But it is also negatively correlated with HDL, so let’s take a look at that.</p>
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-16-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-17-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-18-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-19-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-20-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-21-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="height" class="level3">
<h3 class="anchored" data-anchor-id="height">Height</h3>
<p>In correlation heatmap we can see that is slighty negatively correlated with age and HDL, and positively correlated with weight and hemoglobin.</p>
<p>Let’s take a look at the hemoglobin relationship.</p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-22-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-23-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-24-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-25-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-26-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-27-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="waist" class="level3">
<h3 class="anchored" data-anchor-id="waist">Waist</h3>
<p>Waist is highly correlated with weight and because of that, it should have similar relationships with other variables. So let’s just take a look at categorical variables right after looking at the histogram and Waist-Weight scatter plot.</p>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-28-output-1.png" width="618" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-29-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-30-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-31-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-32-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-33-output-1.png" width="593" height="431"></p>
</div>
</div>
</section>
<section id="eyesight-left-right" class="level3">
<h3 class="anchored" data-anchor-id="eyesight-left-right">Eyesight [left, right]</h3>
<p>For eyesight, there are cases of people being blind in one of their eyes (signaled by value 10 in eyesight) or being completely blind (only one case). We will take a look at histograms with eyesight better than 3 in both eyes</p>
<div class="cell" data-execution_count="34">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-35-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-36-output-1.png" width="597" height="429"></p>
</div>
</div>
<p>From scatter plots we can see that it is fairly symmetrical, so I will only use eyesight left for all the other plots, since they should look basically the same.</p>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-37-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-38-output-1.png" width="597" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-39-output-1.png" width="597" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-40-output-1.png" width="597" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-41-output-1.png" width="597" height="429"></p>
</div>
</div>
</section>
<section id="hearing-left-right" class="level3">
<h3 class="anchored" data-anchor-id="hearing-left-right">Hearing [left, right]</h3>
<p>Hearing is a categorical variable. Since for those we are looking at their relationships with each individual numerical variable in their section in this case we will compare it to other categorical variable and we will look at how much samples fall in each category.</p>
<div class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-42-output-1.png" width="618" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-43-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-44-output-1.png" width="576" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-45-output-1.png" width="618" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-46-output-1.png" width="610" height="429"></p>
</div>
</div>
</section>
<section id="systolic" class="level3">
<h3 class="anchored" data-anchor-id="systolic">Systolic</h3>
<p>Systolic blood pressure doesn’t really show any strong correlation on heatmap except for relaxation, which is most likely diastolic pressure. I will still take a look at it’s relationship with waist, since I would expect it to have some relationship.</p>
<div class="cell" data-execution_count="46">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-47-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-48-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-49-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-50-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-51-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-52-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-53-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="relaxation" class="level3">
<h3 class="anchored" data-anchor-id="relaxation">Relaxation</h3>
<p>Since relaxation is quite similar to systolic pressure, I will only show histogram and plots with categorical variables</p>
<div class="cell" data-execution_count="53">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-54-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-55-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-56-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-57-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-58-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-59-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="fasting-blood-sugar" class="level3">
<h3 class="anchored" data-anchor-id="fasting-blood-sugar">Fasting blood sugar</h3>
<p>Fasting blood sugar shows weak anti-correlation with HDL, so we can look at that. Otherwise the heatmap doesn’t really show anything of interest.</p>
<p>Boxplot shows very strong outliers, expected fasting blood sugar in adults is between 70 and 100 mg/dL, values between 100 and 125 mg/dL should be an alarm for lifestyle change. Anything above means you are probably diabetic. Values of even 200 mg/dL seems very suspicous to me, so I will be removing them.</p>
<div class="cell" data-execution_count="59">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-60-output-1.png" width="545" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"fasting blood sugar"</span>] <span class="op">&lt;</span> <span class="dv">200</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="61">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-62-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-63-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-64-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-65-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-66-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-67-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="cholesterol" class="level3">
<h3 class="anchored" data-anchor-id="cholesterol">Cholesterol</h3>
<p>Cholesterol shows strong correlation with LDL.</p>
<div class="cell" data-execution_count="67">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-68-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-69-output-1.png" width="602" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-70-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-71-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-72-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-73-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="triglyceride" class="level3">
<h3 class="anchored" data-anchor-id="triglyceride">Triglyceride</h3>
<p>Triglyceride refers to body fat and shows anti-correlation with HDL and correlations with weight and waist.</p>
<p>Again, we have some outliers present, I will be removing anything above 400 since the number of deleted entries is negligable.</p>
<div class="cell" data-execution_count="73">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-74-output-1.png" width="555" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"triglyceride"</span>] <span class="op">&lt;</span> <span class="dv">400</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-76-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-77-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-78-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-79-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-80-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-81-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-82-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-83-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="hdl" class="level3">
<h3 class="anchored" data-anchor-id="hdl">HDL</h3>
<p>HDL (high-density lipoprotein) shows anti-correlation with weight, waist and triglyceride. All of those, except for waist, have been plotted so I will skip those here.</p>
<div class="cell" data-execution_count="83">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-84-output-1.png" width="614" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-85-output-1.png" width="597" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-86-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-87-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-88-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-89-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="ldl" class="level3">
<h3 class="anchored" data-anchor-id="ldl">LDL</h3>
<p>LDL (low density lipoprotein) shows anti-correlation with weight and waist and correlation with cholesterol. Cholesterol has already been plotted, but waist and weight haven’t, so let’s do those.</p>
<p>If we take a look at LDL boxplot, we can see that it has some very extreme outliers, so for the sake of plotting, I will filter those out here. And once we get to making predictors, I will also filter those out completely.</p>
<div class="cell" data-execution_count="89">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-90-output-1.png" width="545" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"LDL"</span>] <span class="op">&lt;</span> <span class="dv">500</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="91">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-92-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-93-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-94-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-95-output-1.png" width="593" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-96-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-97-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-98-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="hemoglobin" class="level3">
<h3 class="anchored" data-anchor-id="hemoglobin">Hemoglobin</h3>
<p>Hemoglobin shows correlation with weight and waist.</p>
<div class="cell" data-execution_count="98">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-99-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-100-output-1.png" width="593" height="431"></p>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-101-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="101">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-102-output-1.png" width="602" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-103-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-104-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-105-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-106-output-1.png" width="585" height="429"></p>
</div>
</div>
</section>
<section id="urine-protein" class="level3">
<h3 class="anchored" data-anchor-id="urine-protein">Urine protein</h3>
<p>Urine protein is a categorical variable and thus will be plotted with numerical variables in their section. Here I will be plotting it with other categorical variables (except with hearing)</p>
<p>One oddity with urine protein is that normally it is measured in miligrams, but here it is in values between 1 and 6. Also, the values are heavily skewed towards 1, thus I will be likely removing this column altogether.</p>
<div class="cell" data-execution_count="106">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-107-output-1.png" width="618" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="107">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-108-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="108">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-109-output-1.png" width="618" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-110-output-1.png" width="610" height="429"></p>
</div>
</div>
</section>
<section id="serum-creatinine" class="level3">
<h3 class="anchored" data-anchor-id="serum-creatinine">Serum creatinine</h3>
<p>Serum creatinine refers to how well kindeys are filtering the blood. In the heatmap, it shows some correlation with hemoglobin, height and weight.</p>
<p>On boxplot we can see that creatinine also has quite big outliers, <a href="https://www.medicinenet.com/creatinine_blood_test/article.htm">according to this website</a> we should be expecting values between 0.5 and 1.2 mg. While I could expect 4 mg as an outlier, 10 seems to be quite overblown. For this I will be filtering out anything above 3 mg.</p>
<div class="cell" data-execution_count="110">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-111-output-1.png" width="545" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"serum creatinine"</span>] <span class="op">&lt;</span> <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="112">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-113-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="113">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-114-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="114">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-115-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="115">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-116-output-1.png" width="585" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="116">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-117-output-1.png" width="589" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="117">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-118-output-1.png" width="589" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="118">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-119-output-1.png" width="589" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="119">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-120-output-1.png" width="589" height="429"></p>
</div>
</div>
</section>
<section id="ast" class="level3">
<h3 class="anchored" data-anchor-id="ast">AST</h3>
<p>AST refers to an enzyme whose levels are used as markers of liver health. On the heatmap, it shows correlation with ALT, which is also used for liver diagnoses.</p>
<p>Here we can see that this data set is very.. interesting. According to <a href="https://www.medicalnewstoday.com/articles/320982#sgot-ranges">this website</a> AST levels should be less than 40 U/L. Since size of this dataset is around 160 000 entries I will be aggresively removing everything above 100 U/L.</p>
<div class="cell" data-execution_count="120">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-121-output-1.png" width="547" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"AST"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="122">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-123-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="123">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-124-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="124">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-125-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="125">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-126-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="126">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-127-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="alt" class="level3">
<h3 class="anchored" data-anchor-id="alt">ALT</h3>
<p>ALT, as eluded to, is another enzyme that is used for liver diagnoses.</p>
<p>As we can see here on boxplot, the outliers are quite outrageous. Accoring to <a href="https://www.healthline.com/health/alt#results">this website</a> healthy levels should be from 19 to 33 U/L. So once again, I will take aggressive measures and remove everything above 100 U/L.</p>
<div class="cell" data-execution_count="127">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-128-output-1.png" width="552" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I will remove AST as well so I can scatter plot them</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> data.loc[data[<span class="st">"ALT"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.loc[tmp[<span class="st">"AST"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="129">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-130-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="130">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-131-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="131">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-132-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="132">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-133-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="133">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-134-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="134">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-135-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="gtp" class="level3">
<h3 class="anchored" data-anchor-id="gtp">Gtp</h3>
<p>GTP is quite an odd variable, wikipedia tells me that it is building block for synthesis o RNA, but doesn’t really talk about any diagnoses. And google doesn’t really help. It did find GGT measuring <a href="https://www.ucsfhealth.org/medical-tests/gamma-glutamyl-transferase-(ggt)-blood-test">on this website</a> which says that healthy levels are between 5 and 40 U/L.</p>
<p>On this boxplot we can see that outliers are again quite big, so once again, I will take aggressive measures and remove everything above 100 U/L.</p>
<div class="cell" data-execution_count="135">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-136-output-1.png" width="545" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I will remove AST as well so I can scatter plot them</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.loc[tmp[<span class="st">"Gtp"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="137">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-138-output-1.png" width="610" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="138">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-139-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="139">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-140-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="140">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-141-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="141">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-142-output-1.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="dental-caries" class="level3">
<h3 class="anchored" data-anchor-id="dental-caries">Dental caries</h3>
<p>Categorical variable, it has already been plotted with all numeric variables and with urine protein and hearing. So I will only plot it with smoking.</p>
<div class="cell" data-execution_count="142">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-143-output-1.png" width="618" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="143">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-144-output-1.png" width="610" height="429"></p>
</div>
</div>
</section>
<section id="smoking" class="level3">
<h3 class="anchored" data-anchor-id="smoking">Smoking</h3>
<p>Since smoking has been plotted with everything there is, I will just write some of the relationships that I have noticed.</p>
<div class="cell" data-execution_count="144">
<div class="cell-output cell-output-display">
<p><img src="SmokerPrediction_files/figure-html/cell-145-output-1.png" width="618" height="429"></p>
</div>
</div>
<section id="interesting-relationships" class="level4">
<h4 class="anchored" data-anchor-id="interesting-relationships">Interesting relationships</h4>
<ul>
<li>Younger people seemed to smoke more than older people</li>
<li>People with higher weight are more likely to smoke</li>
<li>Smokers are also taller on average</li>
<li>It seems that in smokers levels of triglyceride are higher</li>
<li>Smokers have lower levels of HDL</li>
<li>Smokers have higher levels of hemoglobin</li>
<li>Levels of serum creatinine are in much smaller ranges than in non-smokers</li>
<li>GTP levels seem to be higher in smokers</li>
<li>Dental caries are more common in smokers</li>
</ul>
</section>
</section>
<section id="conclusions-on-data" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-on-data">Conclusions on data</h3>
<p>It seems that there are several variables based on which we could try to determine whether somebody is smoking or not.</p>
<p>Dataset has several columns with huge outliers and those will be filtered out. Thankfully, the dataset is large enough so it wouldn’t really make a difference.</p>
<p>Another thing is column “Urine protein” which just doesn’t seem to make any sense. Since it also seems very unhelpful, I will be removing it from the dataset.</p>
<p>Big number of variables have largely differing value ranges and thus the will need to be normalized. For that I will try two approaches:</p>
<ul>
<li>Standard score: <span class="math inline">\(x' = \dfrac{x-\mu}{\sigma}\)</span>, this should work since all the variables are resembling normal distribution. I haven’t done any actual statistical testing though</li>
<li>MinMax scaling: this will rescale variables to be between 0 and 1</li>
</ul>
<p>Since there aren’t that many strong correlations, I think that PCA won’t be particularly helpful, so I won’t be using it.</p>
</section>
</section>
<section id="data-preparation-for-categorization" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-for-categorization">Data preparation for categorization</h2>
<p>The goal here is to filter out the outliers. Since I will be using one hot encoder I will also need to transform hearing from text values back to numbers. Since it will be separated into three distinct columns the values themselves don’t really matter, but let’s go with the number of hearing ears.</p>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"fasting blood sugar"</span>] <span class="op">&lt;</span> <span class="dv">200</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"triglyceride"</span>] <span class="op">&lt;</span> <span class="dv">400</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"LDL"</span>] <span class="op">&lt;</span> <span class="dv">500</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"serum creatinine"</span>] <span class="op">&lt;</span> <span class="dv">3</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"AST"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"ALT"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.loc[data[<span class="st">"Gtp"</span>] <span class="op">&lt;</span> <span class="dv">100</span>]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Change hearing back to numbers</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's encode it as "Hearing" = 2, "One-deaf" = 1, "Deaf" = 0</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"hearing"</span>] <span class="op">=</span> data[<span class="st">"hearing"</span>].<span class="bu">map</span>({<span class="st">"Both deaf"</span>: <span class="dv">0</span>, <span class="st">"One deaf"</span>: <span class="dv">1</span>, <span class="st">"Both hearing"</span>: <span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here I will just separate out numeric and categorical variables. And also take extract the target variable.</p>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>l_numeric <span class="op">=</span> [<span class="st">"age"</span>, <span class="st">"height(cm)"</span>, <span class="st">"weight(kg)"</span>, <span class="st">"waist(cm)"</span>, <span class="st">"eyesight(left)"</span>, <span class="st">"eyesight(right)"</span>, <span class="st">"systolic"</span>, <span class="st">"relaxation"</span>, <span class="st">"fasting blood sugar"</span>, <span class="st">"Cholesterol"</span>, <span class="st">"triglyceride"</span>, <span class="st">"HDL"</span>, <span class="st">"LDL"</span>, <span class="st">"hemoglobin"</span>, <span class="st">"serum creatinine"</span>, <span class="st">"AST"</span>, <span class="st">"ALT"</span>, <span class="st">"Gtp"</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Removal of Urine protein</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>l_categorical <span class="op">=</span> [<span class="st">"hearing"</span>, <span class="st">"dental caries"</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>numeric <span class="op">=</span> data[l_numeric]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>categorical <span class="op">=</span> data[l_categorical]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> data[<span class="st">"smoking"</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> data.drop(columns<span class="op">=</span>[<span class="st">"smoking"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training" class="level2">
<h2 class="anchored" data-anchor-id="training">Training</h2>
<section id="creating-transformers-for-data" class="level3">
<h3 class="anchored" data-anchor-id="creating-transformers-for-data">Creating transformers for data</h3>
<p>With that done, let’s create our preprocessors.</p>
<p>For numerical values I will be using MinMaxScaler for one attempt and StandardScaler for another.</p>
<p>For categorical variables I will use OneHotEncoder, this means that hearing will be split into three distinct columns.</p>
<p>What we will end up with are 2 preprocessors:</p>
<ul>
<li>One hot encoder + MinMax scaling</li>
<li>One hot encoder + Standard scaling</li>
</ul>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>minmax_scaler <span class="op">=</span> MinMaxScaler().set_output(transform<span class="op">=</span><span class="st">"pandas"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>standard_scaler <span class="op">=</span> StandardScaler().set_output(transform<span class="op">=</span><span class="st">"pandas"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>onehot_encoder <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>).set_output(transform<span class="op">=</span><span class="st">"pandas"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's also create preprocessor that will do all of this stuff for us in one fell swoop</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>minmax_prep <span class="op">=</span> ColumnTransformer(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"one-hot-encoder"</span>, onehot_encoder, l_categorical),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"minmax_scaler"</span>, minmax_scaler, l_numeric)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>standard_prep <span class="op">=</span> ColumnTransformer(</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"one-hot-encoder"</span>, onehot_encoder, l_categorical),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"standard_scaler"</span>, standard_scaler, l_numeric)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s get us some training and testing data for each of the column transformer.</p>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Xmm <span class="op">=</span> minmax_prep.fit_transform(df)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Xstd <span class="op">=</span> standard_prep.fit_transform(df) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Xmm_train, Xmm_test, ymm_train, ymm_test <span class="op">=</span> train_test_split(Xmm, target, test_size<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Xstd_train, Xstd_test, ystd_train, ystd_test <span class="op">=</span> train_test_split(Xstd, target, test_size<span class="op">=</span><span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="training-logistic-regression">Training Logistic regression</h3>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mm_log_reg <span class="op">=</span> LogisticRegressionCV(max_iter<span class="op">=</span><span class="dv">500</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mm_log_reg.fit(Xmm_train, ymm_train)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>std_log_reg <span class="op">=</span> LogisticRegressionCV(max_iter<span class="op">=</span><span class="dv">500</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>std_log_reg.fit(Xstd_train, ystd_train)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of MinMax scaling using logistic regression: </span><span class="sc">{</span>mm_log_reg<span class="sc">.</span>score(Xmm_test, ymm_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of standard scaling using logistic regression: </span><span class="sc">{</span>std_log_reg<span class="sc">.</span>score(Xstd_test, ystd_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of MinMax scaling using logistic regression: 0.7492586706859549
Accuracy of standard scaling using logistic regression: 0.7492914366224873</code></pre>
</div>
</div>
<p>Here we can see that we have about the same accuracy for both minmax and standard scaling, with the score being ~0.749, and standard scaling is performing slightly worse.</p>
<p>Now let’s try to take a look if we can perform slightly better with some other methods</p>
</section>
<section id="random-forest-classifier" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-classifier">Random forest classifier</h3>
<p>For random forest classifier I decided to use RandomizedSearch with cross validation to find optimal parameters.</p>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {<span class="st">'n_estimators'</span> : np.arange(<span class="dv">10</span>,<span class="dv">100</span>)}</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>mm_forest <span class="op">=</span> RandomizedSearchCV(RandomForestClassifier(), parameters)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>mm_forest.fit(Xmm_train, ymm_train)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>std_forest <span class="op">=</span> RandomizedSearchCV(RandomForestClassifier(), parameters)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>std_forest.fit(Xstd_train, ystd_train)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of MinMax scaling using random forest: </span><span class="sc">{</span>mm_forest<span class="sc">.</span>best_score_<span class="sc">}</span><span class="ss"> with estimators </span><span class="sc">{</span>mm_forest<span class="sc">.</span>best_estimator_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of standard scaling using random forest: </span><span class="sc">{</span>std_forest<span class="sc">.</span>best_score_<span class="sc">}</span><span class="ss"> with estimators </span><span class="sc">{</span>std_forest<span class="sc">.</span>best_estimator_<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of MinMax scaling using random forest: 0.7715849563816318 with estimators RandomForestClassifier(n_estimators=87)
Accuracy of standard scaling using random forest: 0.7722949091636209 with estimators RandomForestClassifier(n_estimators=99)</code></pre>
</div>
</div>
<p>For random forest classifier we can see that the accuracy has risen compared to logistic regression. MinMax scaling is still performing very slightly better than standard scaling.</p>
</section>
<section id="svm" class="level3">
<h3 class="anchored" data-anchor-id="svm">SVM</h3>
<p>While I have planned to compare several SVM kernels, given the sheer size of my dataset and severe limitations on time I can spend on this, taking into account rendering the document, I will use only RBF kernel, which has performed best in my testing.</p>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mm_svm <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>, gamma<span class="op">=</span><span class="st">'scale'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>std_svm <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>, gamma<span class="op">=</span><span class="st">'scale'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>mm_svm.fit(Xmm_train, ymm_train)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>std_svm.fit(Xstd_train, ystd_train)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of MinMax scaling using SVM: </span><span class="sc">{</span>mm_svm<span class="sc">.</span>score(Xmm_test, ymm_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of standard scaling using SVM: </span><span class="sc">{</span>std_svm<span class="sc">.</span>score(Xstd_test, ystd_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of MinMax scaling using SVM: 0.7701305722570816
Accuracy of standard scaling using SVM: 0.7725388685922115</code></pre>
</div>
</div>
<p>If we look at results here, standard scaling is finally outperforming minmax and by non-negligable ammount.</p>
</section>
<section id="sgd-classifier" class="level3">
<h3 class="anchored" data-anchor-id="sgd-classifier">SGD Classifier</h3>
<p>One thing that apparently performs pretty well on large samples is SGD Classifier, so I would like to test it here.</p>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mm_sgd <span class="op">=</span> SGDClassifier()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>std_sgd <span class="op">=</span> SGDClassifier()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>mm_sgd.fit(Xmm_train, ymm_train)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>std_sgd.fit(Xstd_train, ystd_train)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of MinMax scaling using SGD: </span><span class="sc">{</span>mm_sgd<span class="sc">.</span>score(Xmm_test, ymm_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of standard scaling using SGD: </span><span class="sc">{</span>std_sgd<span class="sc">.</span>score(Xstd_test, ystd_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of MinMax scaling using SGD: 0.7550418584839201
Accuracy of standard scaling using SGD: 0.7415095266960468</code></pre>
</div>
</div>
<p>By itself SGD doesn’t really perform that well. Let’s try to use kernel approximation with RBF sampler, since it RBF performed so well with SVM</p>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mm_sgd_rbf <span class="op">=</span> SGDClassifier()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>std_sgd_rbf <span class="op">=</span> SGDClassifier()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> RBFSampler()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>Xmm_rbf <span class="op">=</span> sampler.fit_transform(Xmm)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>Xstd_rbf <span class="op">=</span> sampler.fit_transform(Xstd)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>Xmm_rbf_train, Xmm_rbf_test, ymm_rbf_train, ymm_rbf_test <span class="op">=</span> train_test_split(Xmm, target, test_size<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>Xstd_rbf_train, Xstd_rbf_test, ystd_rbf_train, ystd_rbf_test <span class="op">=</span> train_test_split(Xstd, target, test_size<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>mm_sgd_rbf.fit(Xmm_rbf_train, ymm_rbf_train)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>std_sgd_rbf.fit(Xstd_rbf_train, ystd_rbf_train)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of MinMax scaling using SGD with RBF kernel: </span><span class="sc">{</span>mm_sgd_rbf<span class="sc">.</span>score(Xmm_rbf_test, ymm_rbf_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of standard scaling using SGD with RBF kernel: </span><span class="sc">{</span>std_sgd_rbf<span class="sc">.</span>score(Xstd_rbf_test, ystd_rbf_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy of MinMax scaling using SGD with RBF kernel: 0.7526007962122577
Accuracy of standard scaling using SGD with RBF kernel: 0.7516178181162864</code></pre>
</div>
</div>
<p>There was an attempt, maybe by testing more kernel approximations I could get somewhere, but I will leave that be.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>For Logistic regression, minmax scaling had better performance, but by negligable ammount.</p>
<p>For random forest minmax also took the cake, but again, by negligable ammount</p>
<p>When it came to SVM however, standard scaling had better performance than minmax scaling. The difference this time was, however, quite substantial.</p>
<p>Now, let’s compare how each method fared for both minmax and standard</p>
<p>Minmax:</p>
<ol type="1">
<li>Random Forest</li>
<li>SVM</li>
<li>SGD</li>
<li>SGD with RBF kernel approximation</li>
<li>Logistic regression</li>
</ol>
<p>Standard scaling:</p>
<ol type="1">
<li>SVM</li>
<li>Random Forest</li>
<li>SGD</li>
<li>SDG with RBF kernel approximation</li>
<li>Logistic regression</li>
</ol>
<p>When comparing random forest for MinMax and SVM for standard scaling, it seems that SVM for standard scaling comes on top, so I will be using that for the actual sumbmission.</p>
</section>
</section>
<section id="submission-of-my-predictions" class="level2">
<h2 class="anchored" data-anchor-id="submission-of-my-predictions">Submission of my predictions</h2>
<p>Data to classify for the submission is in <em>test.csv</em> file, so let’s get the data in.</p>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_csv(<span class="st">'Smokers/test.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since submission is in format [id, smoking] let’s check to make sure that the id’s match up</p>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Head"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.head(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tail"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.tail(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Head
        age  height(cm)  weight(kg)  waist(cm)  eyesight(left)  \
id                                                               
159256   40         165          70       84.0             1.2   
159257   80         160          60       93.0             1.0   
159258   60         170          70       86.5             0.6   
159259   40         160          50       67.0             0.3   
159260   40         170          75       89.4             1.0   

        eyesight(right)  hearing(left)  hearing(right)  systolic  relaxation  \
id                                                                             
159256              1.2              1               1       130          89   
159257              1.0              2               2       144          72   
159258              0.7              1               1       117          75   
159259              0.4              1               1       116          62   
159260              0.9              1               1       132          94   

        ...  triglyceride  HDL  LDL  hemoglobin  Urine protein  \
id      ...                                                      
159256  ...           186   49  115        14.2              1   
159257  ...           158   35  104        13.0              1   
159258  ...           173   39   88        15.4              1   
159259  ...            47   75  128        14.5              1   
159260  ...           100   39  123        16.5              1   

        serum creatinine  AST  ALT  Gtp  dental caries  
id                                                      
159256               0.9   19   25   32              0  
159257               1.1   20   12   24              0  
159258               1.4   38   60   36              0  
159259               0.6   25   18   10              1  
159260               1.0   30   39   27              1  

[5 rows x 22 columns] 

Tail
        age  height(cm)  weight(kg)  waist(cm)  eyesight(left)  \
id                                                               
265422   40         165          60       78.0             0.8   
265423   40         170          85       95.0             1.2   
265424   35         170          85       89.0             1.2   
265425   40         160          60       67.0             0.7   
265426   50         150          50       80.0             0.9   

        eyesight(right)  hearing(left)  hearing(right)  systolic  relaxation  \
id                                                                             
265422              0.9              1               1       112          78   
265423              1.2              1               1       130          90   
265424              1.2              1               1       131          86   
265425              0.8              1               1       120          80   
265426              1.0              1               1       115          67   

        ...  triglyceride  HDL  LDL  hemoglobin  Urine protein  \
id      ...                                                      
265422  ...            82   59  149        16.4              1   
265423  ...           186   44  100        16.0              2   
265424  ...            76   53  142        15.9              1   
265425  ...            81   55  103        13.9              1   
265426  ...            96   48  144        13.0              1   

        serum creatinine  AST  ALT  Gtp  dental caries  
id                                                      
265422               1.1   24   31   28              0  
265423               1.0   25   31   38              0  
265424               0.8   33   32   24              1  
265425               0.6   42   36   32              0  
265426               0.6   18   11   17              1  

[5 rows x 22 columns] 
</code></pre>
</div>
</div>
<p>Id’s are matching up, so we can proceed to pre-preprocessing.</p>
<p>The only thing I will need to do here is to merge hearing (left) and (right) in the same way I did in the training part. Then Sklearn can take the wheel.</p>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> [<span class="st">"Both hearing"</span>, <span class="st">"One deaf"</span>, <span class="st">"Both deaf"</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>hear <span class="op">=</span> test_data.loc[:, [<span class="st">"hearing(left)"</span>, <span class="st">"hearing(right)"</span>]]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>hearing <span class="op">=</span> []</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> hear.iterrows():</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    hearing.append(idx[row.iloc[<span class="dv">0</span>] <span class="op">+</span> row.iloc[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span>])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>test_data.loc[:, <span class="st">"hearing"</span>] <span class="op">=</span> hearing</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">"hearing"</span>] <span class="op">=</span> test_data[<span class="st">"hearing"</span>].<span class="bu">map</span>({<span class="st">"Both deaf"</span>: <span class="dv">0</span>, <span class="st">"One deaf"</span>: <span class="dv">1</span>, <span class="st">"Both hearing"</span>: <span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So now we just transform our data and feed it to out trained SVM classifier</p>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> standard_prep.fit_transform(test_data)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> std_svm.predict(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After getting prediction from the SVM model it’s time to put it into a dataframe and export it as an csv file.</p>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">"smoking"</span>] <span class="op">=</span> prediction</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> test_data[<span class="st">"smoking"</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(output.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>id
159256    1
159257    0
159258    0
159259    0
159260    1
Name: smoking, dtype: int64</code></pre>
</div>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>output.to_csv(<span class="st">'Smokers/my_submission.csv'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>And here we go, those are the results of my work. Public score of 0.78 and private 0.778.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Results.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">results</figcaption>
</figure>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>